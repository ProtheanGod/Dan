#! /usr/bin/env php
<?php

error_reporting(E_ALL);
ini_set("display_errors", true);

if (phpversion() < '7')
    die('PHP 7 is REQUIRED. Please update your php installation to at least PHP 7');

if (!defined('STDIN'))
    throw new Exception("CLI Only");

libxml_use_internal_errors(true);
date_default_timezone_set("UTC");

define("ROOT_DIR", __DIR__);
define("BASE_DIR", __DIR__);
define('LOGS_DIR', ROOT_DIR . '/logs');
define('CONFIG_DIR', ROOT_DIR . '/config');
define('STORAGE_DIR', ROOT_DIR . '/storage');
define('PLUGIN_DIR', ROOT_DIR . '/plugins');
define('COMMAND_DIR', ROOT_DIR . '/commands');

$loader = require(BASE_DIR . '/vendor/autoload.php');

set_error_handler(function($severity, $message, $filename, $lineno)
{
    debug("-------------------------");
    controlLog("{red}[{$severity}] PHP ERROR: {$message} in " . relative($filename) . " on line {$lineno}", true);
    debug("-------------------------");
});

(new Dan\Core\Dan($loader))->boot();